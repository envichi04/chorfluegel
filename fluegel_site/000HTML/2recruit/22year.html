<!DOCTYPE html>
<html dir="ltr" lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="フリューゲルの一年">
<title>フリューゲルの一年</title>
<link rel="icon" href="../../999contents/00common_images/favicon.ico">
<link rel="stylesheet" href="../../999contents/777css/structure.css">
<link rel="stylesheet" href="../../999contents/777css/carousel.css">
<link rel="stylesheet" href="../../999contents/777css/22year.css">
</head>

<body>

<header class="full-width-header">
  <div class="inner-container">
    <div class="top-links">
      <a href="../index.html">Home</a>
      <a href="../6info/63diary.html">日記</a>
      <a href="../6info/65search.html">サイトマップ</a>
    </div>

    <a href="../index.html" class="title-link-wrapper">
      <div class="title-area">
        <img src="../../999contents/00common_images/logo.png" alt="ロゴ" class="site-logo">
        <h1 class="site-title">早稲田大学コール・フリューゲル</h1>
      </div>
    </a>
  </div>
</header>

<nav class="full-width-nav">
  <div class="inner-container">
    <div class="menu-trigger" id="menu-trigger">
      <span></span>
      <span></span>
      <span></span>
    </div>

    <ul class="ddmenu2" id="nav-menu">
      <li><a href="../index.html">Home</a></li>
      <li>
        <a href="../1about/10aboutus.html">当団について</a>
        <ul>
          <li><a href="../1about/11greeting.html">ご挨拶</a></li>
          <li><a href="../1about/12history.html">沿革</a></li>
          <li><a href="../1about/13teachers.html">先生方紹介</a></li>
        </ul>
      </li>
      <li>
        <a href="../2recruit/20recruit.html">新入生募集</a>
        <ul>
          <li><a href="../2recruit/21aboutfluegel.html">フリューゲルについて</a></li>
          <li><a href="../2recruit/22year.html">フリューゲルの一年</a></li>
          <li><a href="../2recruit/23qa.html">Q&A</a></li>
        </ul>
      </li>
      <li>
        <a href="../3concerts/30concerts.html">演奏会</a>
        <ul>
          <li><a href="../3concerts/31regularconcert.html">定期演奏会</a></li>
          <li><a href="../3concerts/32history.html">過去の定期演奏会</a></li>
          <li><a href="../3concerts/33irakaconcert.html">甍演奏会</a></li>
          <li><a href="../3concerts/34record.html">活動記録</a></li>
        </ul>
      </li>
      <li>
        <a href="../4contest/40contest.html">コンクール</a>
        <ul>
          <li><a href="../4contest/41tokyo.html">東京都合唱コンクール</a></li>
          <li><a href="../4contest/42national.html">全日本合唱コンクール</a></li>
        </ul>
      </li>
      <li>
        <a href="../5partners/50partners.html">関連団体</a>
        <ul>
          <li><a href="../5partners/51shsglee.html">早稲田大学高等学院グリークラブ</a></li>
          <li><a href="../5partners/52irakakai.html">いらか会合唱団</a></li>
          <li><a href="../5partners/53choriraka.html">男声合唱団甍</a></li>
          <li><a href="../5partners/54shinnyuukai.html">晋友会合唱団</a></li>
        </ul>
      </li>
      <li>
        <a href="../6info/60information.html">お問い合わせ・コンテンツ</a>
        <ul>
          <li><a href="../6info/61contact.html">お問い合わせ</a></li>
          <li><a href="../6info/62access.html">アクセス</a></li>
          <li><a href="../6info/63diary.html">日記</a></li>
          <li><a href="../6info/64sns.html">SNS</a></li>
          <li><a href="../6info/65search.html">サイトマップ</a></li>
        </ul>
      </li>
    </ul>
  </div>
</nav>

<main class="inner-container content-body">
  <nav aria-label="breadcrumb">
    <ul class="breadcrumb">
      <li class="breadcrumb-item"><a href="../index.html">Home</a></li>
      <li class="breadcrumb-item"><a href="20recruit.html">新入生募集</a></li>
      <li class="breadcrumb-item active" aria-current="page">フリューゲルの一年</li>
    </ul>
  </nav>

  <div class="image-carousel" id="carousel">
    <div class="carousel-inner" id="carousel-inner"></div>
  </div>

  <h2 class="main-heading">2026年 年間行事</h2>
  <div id="history-timeline" class="timeline-container"></div>
  <br><br><br>
  <div id="dynamic-content"></div>

  <div class="border-line"></div>

  <div class="list-link">
    <a href="21aboutfluegel.html">〉 フリューゲルについて</a><br>
    <a href="22year.html">〉 フリューゲルの一年</a><br>
    <a href="23qa.html">〉 Q&A</a><br>
  </div>
</main>

<footer class="full-width-footer">
  <div class="inner-container">
    <p class="copyright">&copy; 2026 早稲田大学コール・フリューゲル All Rights Reserved.</p>
  </div>
</footer>

<script>
  // --- 設定：ファイルの場所 ---
  const basePath = '../../999contents/22year/';

  // --- 年間スケジュール（4行1セット：日付 / タイトル / 場所 / 本文） ---
  async function loadHistory() {
    const container = document.getElementById('history-timeline');
    if (!container) return;

    try {
      const response = await fetch(basePath + 'year-schedule.txt');
      if (!response.ok) throw new Error('Schedule TXT not found');
      
      const text = await response.text();
      // 空行を除去
      const lines = text.split(/\r?\n/).map(l => l.trim()).filter(l => l !== "");
      
      let htmlContent = '';
      // 4行ずつループ（日付、タイトル、場所、本文）
      for (let i = 0; i < lines.length; i += 4) {
        const date = lines[i] || "";
        const title = lines[i + 1] || "";
        const location = lines[i + 2] || "";
        const body = lines[i + 3] || "";

        htmlContent += `
          <div class="timeline-item">
            <div class="timeline-left">
              <span class="timeline-date">${date}</span>
            </div>
            <div class="timeline-right">
              <h4 class="timeline-title">${title}</h4>
              <div class="timeline-location">📍 ${location}</div>
              <p class="timeline-text">${body}</p>
            </div>
          </div>
        `;
      }
      container.innerHTML = htmlContent;
    } catch (error) {
      console.error('Timeline Error:', error);
      container.innerHTML = "<p>スケジュールの読み込みに失敗しました。</p>";
    }
  }
  /**
   * 2. 下部コンテンツ（本文）の読み込み
   * 区切り文字「===」でセクションを分割
   */
  async function loadBodyText() {
    const container = document.getElementById('dynamic-content');
    if (!container) return;

    try {
      const response = await fetch(basePath + 'year-body.txt');
      if (!response.ok) throw new Error('Body TXT not found');
      
      const text = await response.text();
      const sections = text.split(/\n\s*===\s*\n/);
      
      let htmlContent = '';
      sections.forEach(section => {
        const lines = section.split(/\r?\n/).map(l => l.trim()).filter(l => l !== "");
        if (lines.length === 0) return;

        const title = lines[0]; // 1行目は見出し
        const imgIndex = lines.findIndex((l, idx) => idx > 0 && /\.(jpg|jpeg|png|gif)$/i.test(l));

        let imageHtml = '';
        if (imgIndex !== -1) {
          const photoName = lines[imgIndex];
          imageHtml = `<div class="body-image-wrapper"><img src="${basePath}${photoName}" class="full-width-img"></div>`;
        }

        const bodyLines = lines.filter((l, idx) => idx > 0 && idx !== imgIndex && l !== "なし" && l !== "(なし)");
        const bodyText = bodyLines.join('<br>');

        htmlContent += `
          <div class="content-section">
            <h2 class="main-heading">${title}</h2>
            ${imageHtml}
            <div class="standard-text">${bodyText}</div>
          </div>
        `;
      });
      container.innerHTML = htmlContent;
    } catch (error) {
      console.error('Body Error:', error);
    }
  }

  /**
   * 3. 画像カルーセルの初期化
   */
  const carouselInner = document.getElementById('carousel-inner');

  async function initCarousel() {
    if (!carouselInner) return;
    try {
      const response = await fetch(basePath + 'carousel.txt');
      if (!response.ok) throw new Error('Carousel TXT not found');
      
      const text = await response.text();
      const photoList = text.split(/\r?\n/).map(l => l.trim()).filter(l => l !== "");
      const doubleList = [...photoList, ...photoList];

      carouselInner.innerHTML = doubleList.map(fileName => 
        `<div class="carousel-item"><img src="${basePath}${fileName}" alt="活動写真"></div>`
      ).join('');

      setInterval(autoScroll, 5000);
    } catch (error) {
      console.error('Carousel Error:', error);
    }
  }

  function autoScroll() {
    const slideWidth = carouselInner.clientWidth;
    if (carouselInner.scrollLeft >= carouselInner.scrollWidth / 2 - 10) {
      carouselInner.style.scrollBehavior = 'auto';
      carouselInner.scrollLeft = 0;
      setTimeout(() => {
        carouselInner.style.scrollBehavior = 'smooth';
        carouselInner.scrollBy({ left: slideWidth, behavior: 'smooth' });
      }, 50);
    } else {
      carouselInner.style.scrollBehavior = 'smooth';
      carouselInner.scrollBy({ left: slideWidth, behavior: 'smooth' });
    }
  }

  // --- 4. 実行制御 ---
  window.onload = () => {
    initCarousel();
    loadHistory();
    loadBodyText();
  };

  // メニューの開閉
  document.getElementById('menu-trigger').onclick = function() {
    this.classList.toggle('active');
    document.getElementById('nav-menu').classList.toggle('open');
  };
</script>

</body>
</html>