<!DOCTYPE html>
<html dir="ltr" lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="早稲田大学コール・フリューゲル INDEX">
  <title>早稲田大学コール・フリューゲル - HOME</title>
  <link rel="icon" href="../999contents/00common_images/favicon.ico">
  <link rel="stylesheet" href="../999contents/777css/structure.css">
  <link rel="stylesheet" href="../999contents/777css/00home.css">
</head>

<body>

  <header class="full-width-header">
    <div class="inner-container">
      <div class="top-links">
        <a href="index.html">Home</a>
        <a href="6info/63diary.html">日記</a>
        <a href="6info/65search.html">サイトマップ</a>
      </div>

      <a href="index.html" class="title-link-wrapper">
        <div class="title-area">
          <img src="../999contents/00common_images/logo.png" alt="ロゴ" class="site-logo">
          <h1 class="site-title">早稲田大学コール・フリューゲル</h1>
        </div>
      </a>
    </div>
  </header>

  <nav class="full-width-nav">
    <div class="inner-container">
      <div class="menu-trigger" id="menu-trigger">
        <span></span><span></span><span></span>
      </div>

      <ul class="ddmenu2" id="nav-menu">
        <li><a href="index.html">Home</a></li>
        <li><a href="0schedule/00schedule.html">年間行事</a></li>
        <li><a href="1about/10aboutus.html">当団について</a>
          <span class="submenu-toggle"></span>
          <ul>
            <li><a href="1about/11greeting.html">ご挨拶</a></li>
            <li><a href="1about/12history.html">沿革</a></li>
            <li><a href="1about/13teachers.html">先生方紹介</a></li>
          </ul>
        </li>
        <li><a href="2recruit/20recruit.html">新入生募集</a>
          <span class="submenu-toggle"></span>
          <ul>
            <li><a href="2recruit/21aboutfluegel.html">フリューゲルについて</a></li>
            <li><a href="2recruit/23qa.html">Q&A</a></li>
          </ul>
        </li>
        <li><a href="3concerts/30concerts.html">演奏会</a>
          <span class="submenu-toggle"></span>
          <ul>
            <li><a href="3concerts/31regularconcert.html">定期演奏会</a></li>
            <li><a href="3concerts/32history.html">過去の定期演奏会</a></li>
            <li><a href="3concerts/33irakaconcert.html">甍演奏会</a></li>
            <li><a href="3concerts/34record.html">活動記録</a></li>
          </ul>
        </li>
        <li><a href="4contest/40contest.html">コンクール</a>
          <span class="submenu-toggle"></span>
          <ul>
            <li><a href="4contest/41tokyo.html">東京都合唱コンクール</a></li>
            <li><a href="4contest/42national.html">全日本合唱コンクール</a></li>
          </ul>
        </li>
        <li><a href="5partners/50partners.html">関連団体</a>
          <span class="submenu-toggle"></span>
          <ul>
            <li><a href="5partners/51shsglee.html">早稲田大学高等学院グリークラブ</a></li>
            <li><a href="5partners/52irakakai.html">いらか会合唱団</a></li>
            <li><a href="5partners/53choriraka.html">男声合唱団　甍</a></li>
            <li><a href="5partners/54shinnyuukai.html">晋友会合唱団</a></li>
          </ul>
        </li>
        <li><a href="6info/60information.html">お問い合わせ</a>
          <span class="submenu-toggle"></span>
          <ul>
            <li><a href="6info/61contact.html">お問い合わせ</a></li>
            <li><a href="6info/63diary.html">日記</a></li>
            <li><a href="6info/65search.html">サイトマップ</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </nav>

  <main class="inner-container content-body">
    <div id="dynamic-content">
      <p>読み込み中...</p>
    </div>

    <section class="news-section">
      <div id="news-card-container" class="card-container"></div>
    </section>

    <div class="border-line"></div>

    <div class="list-link">
      <a href="1about/10aboutus.html">〉 当団について</a><br>
      <a href="2recruit/20recruit.html">〉 新入生募集</a><br>
      <a href="3concerts/30concerts.html">〉 演奏会 </a><br>
      <a href="4contest/40contest.html">〉 コンクール</a><br>
      <a href="5partners/50partners.html">〉 関連団体</a><br>
      <a href="6info/60information.html">〉 お問い合わせ</a><br>
    </div>
  </main>

  <footer class="full-width-footer">
    <div class="inner-container">
      <div class="footer-content">
        <div class="sns-footer-links">
          <a href="https://twitter.com/chorfluegel" target="_blank" rel="noopener noreferrer" class="sns-item">
            <img src="../999contents/00common_images/x-icon.png" alt="X" class="sns-icon">
            <span>公式Twitter</span>
          </a>
          <a href="https://www.instagram.com/chorfluegel" target="_blank" rel="noopener noreferrer" class="sns-item">
            <img src="../999contents/00common_images/insta-icon.png" alt="Instagram" class="sns-icon">
            <span>公式Instagram</span>
          </a>
          <a href="https://youtube.com/..." target="_blank" rel="noopener noreferrer" class="sns-item">
            <img src="../999contents/00common_images/youtube-icon.png" alt="YouTube" class="sns-icon">
            <span>YouTube</span>
          </a>
        </div>
        <p style="text-align: center;" class="copyright">&copy; 2026 早稲田大学コール・フリューゲル <br>All Rights Reserved.</p>
      </div>
    </div>
  </footer>

  <script>
    // ニュースカードの一括読み込み
    async function loadAllNews(fileUrl, containerId) {
      try {
        const response = await fetch(fileUrl);
        if (!response.ok) throw new Error('読み込みエラー');
        const fullText = await response.text();
        const lines = fullText.split(/\r?\n/).filter(line => line.trim() !== "");
        const container = document.getElementById(containerId);
        let htmlContent = '';

        // 4行1セットでループ（最大3つまで）
        for (let i = 0; i < lines.length && i < 12; i += 4) {
          const title = lines[i];
          const photo = lines[i + 1];
          const text = lines[i + 2];
          const link = lines[i + 3];

          htmlContent += `
          <div class="news-card">
            <div class="card-img-wrapper">
              <img src="../999contents/00index/${photo}" alt="${title}">
            </div>
            <div class="card-content">
              <h3 class="card-title">${title}</h3>
              <p class="card-text">${text}</p>
              <a href="${link}" class="btn-detail">詳しく見る</a>
            </div>
          </div>
        `;
        }
        container.innerHTML = htmlContent;
      } catch (error) {
        console.error('エラー:', error);
      }
    }

    loadAllNews('../999contents/00index/news.txt', 'news-card-container');

    // --- 1. 画像カルーセル設定（テキスト読み込み版） ---
    const photoPath = '../999contents/00index/';
    const txtPath = photoPath + 'carousel.txt'; // txtファイルの場所
    const carouselInner = document.getElementById('carousel-inner');

    async function initCarousel() {
      try {
        const response = await fetch(txtPath);
        if (!response.ok) throw new Error('カルーセル用テキストが見つかりません');
        const text = await response.text();

        // 改行で分割し、空行を除去して配列にする
        const photoList = text.split(/\r?\n/).map(line => line.trim()).filter(line => line !== "");

        // 無限ループ用にリストを2倍にする
        const doubleList = [...photoList, ...photoList];

        // 要素の生成
        doubleList.forEach(fileName => {
          const item = document.createElement('div');
          item.className = 'carousel-item';
          item.innerHTML = `<img src="${photoPath}${fileName}" alt="活動写真">`;
          carouselInner.appendChild(item);
        });

        // カルーセルが生成されてから自動スクロールを開始
        startAutoScroll();

      } catch (error) {
        console.error('カルーセル読み込みエラー:', error);
      }
    }

    // 自動スワイプ & ループ処理
    function autoScroll() {
      const slideWidth = carouselInner.clientWidth;
      const currentScroll = carouselInner.scrollLeft;
      const maxScroll = carouselInner.scrollWidth / 2;

      if (currentScroll >= maxScroll - 10) {
        carouselInner.style.scrollBehavior = 'auto';
        carouselInner.scrollLeft = 0;
        setTimeout(() => {
          carouselInner.style.scrollBehavior = 'smooth';
          carouselInner.scrollBy({ left: slideWidth, behavior: 'smooth' });
        }, 50);
      } else {
        carouselInner.style.scrollBehavior = 'smooth';
        carouselInner.scrollBy({ left: slideWidth, behavior: 'smooth' });
      }
    }

    function startAutoScroll() {
      setInterval(autoScroll, 5000);
    }

    // 実行！
    initCarousel();

    // 2 --- 汎用読み込み本文関数：見出し、画像（あれば）、本文 ---
    async function loadBodyText(fileUrl) {
      try {
        const response = await fetch(fileUrl);
        if (!response.ok) throw new Error('読み込み失敗');
        const fullText = await response.text();

        // 区切り文字「===」でセクションを分割
        const sections = fullText.split(/\n\s*===\s*\n/);
        const container = document.getElementById('dynamic-content');
        container.innerHTML = '';

        sections.forEach(section => {
          // 全ての行を配列にし、余白を削る
          const lines = section.split(/\r?\n/).map(line => line.trim());
          // 空白行を除いた、中身のある行だけを特定
          const activeLines = lines.filter(line => line !== "");

          if (activeLines.length === 0) return;

          const title = activeLines[0]; // 1行目は見出し

          // 2行目以降から「.png, .jpg, .jpeg, .gif」を探す
          const imgIndex = activeLines.findIndex((line, idx) => idx > 0 && /\.(jpg|jpeg|png|gif)$/i.test(line));

          let imageHtml = '';
          let bodyLines = [];

          if (imgIndex !== -1) {
            // 画像ファイルが見つかった場合
            const photoName = activeLines[imgIndex];
            imageHtml = `<div class="body-image-wrapper"><img src="../../999contents/40contest/${photoName}" class="full-width-img"></div>`;
            // 画像ファイル名以外の行（タイトルより後）を本文候補にする
            bodyLines = activeLines.filter((_, idx) => idx > 0 && idx !== imgIndex);
          } else {
            // 画像がない場合
            bodyLines = activeLines.slice(1);
          }

          // 本文から「(なし)」や「なし」という指示文字を排除して結合
          const bodyText = bodyLines
            .filter(l => l !== "(なし)" && l !== "なし")
            .join('<br>');

          const sectionHtml = `
          <div class="content-section">
            <h2 class="main-heading">${title}</h2>
            ${imageHtml}
            <div class="standard-text">${bodyText}</div>
          </div>
        `;
          container.innerHTML += sectionHtml;
        });
      } catch (error) {
        console.error('Error:', error);
        document.getElementById('dynamic-content').innerHTML = "データの読み込みに失敗しました。";
      }
    }

    // 関数を呼び出し
    loadBodyText('../999contents/00index/index.txt');

    //3 ---スマホ用メニュー ---
    document.addEventListener('DOMContentLoaded', () => {
      // --- 1. メニュー制御（ハンバーガーボタン） ---
      const trigger = document.getElementById('menu-trigger');
      const menu = document.getElementById('nav-menu');

      if (trigger && menu) {
        trigger.addEventListener('click', () => {
          trigger.classList.toggle('active');
          menu.classList.toggle('open');
        });
      }

      // --- 2. スマホ用サブメニュー制御（矢印ボタンで開閉） ---
      const toggles = document.querySelectorAll('.submenu-toggle');

      toggles.forEach(toggle => {
        toggle.addEventListener('click', () => {
          if (window.innerWidth <= 1000) {
            const submenu = toggle.nextElementSibling; // 次にある <ul> を取得

            if (submenu && submenu.tagName === 'UL') {
              // 他のメニューを閉じる処理（お好みで）
              document.querySelectorAll('.ddmenu2 ul.show').forEach(openMenu => {
                if (openMenu !== submenu) openMenu.classList.remove('show');
              });
              document.querySelectorAll('.submenu-toggle.active').forEach(activeToggle => {
                if (activeToggle !== toggle) activeToggle.classList.remove('active');
              });

              // 自分のサブメニューを開閉
              submenu.classList.toggle('show');
              toggle.classList.toggle('active'); // 矢印の回転用
            }
          }
        });
      });
    });
  </script>
</body>

</html>